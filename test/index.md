# Local Markdown Viewer - テストファイル一覧

このディレクトリには、Local Markdown Viewerの各機能をテストするためのMarkdownファイルが含まれています。

---

## 📊 テスト概要表

| No | テスト名 | ファイル | 推奨度 | カテゴリ |
|:--:|---------|---------|:------:|---------|
| 1 | [基本機能テスト](#1-基本機能テストbasic-featuresmd) | [basic-features.md](basic-features.md) | ⭐⭐⭐⭐⭐ | 基本 |
| 2 | [セキュリティテスト](#2-セキュリティテストsecurity-testsmd) | [security-tests.md](security-tests.md) | ⭐⭐⭐⭐⭐ | セキュリティ |
| 3 | [HTMLタグテスト](#3-htmlタグテストhtml-tags-testmd) | [html-tags-test.md](html-tags-test.md) | ⭐⭐⭐⭐ | 互換性 |
| 4 | [KaTeX数式テスト](#4-katex数式テストkatex-testsmd) | [katex-tests.md](katex-tests.md) | ⭐⭐⭐⭐ | 数式 |
| 5 | [KaTeX $記号誤検知テスト](#5-katex-記号誤検知テストkatex-dollar-sign-testmd) | [katex-dollar-sign-test.md](katex-dollar-sign-test.md) | ⭐⭐⭐⭐ | 数式 |
| 6 | [Mermaidダイアグラムテスト](#6-mermaidダイアグラムテストmermaid-testsmd) | [mermaid-tests.md](mermaid-tests.md) | ⭐⭐⭐⭐ | ダイアグラム |
| 7 | [シンタックスハイライトテスト](#7-シンタックスハイライトテストsyntax-highlight-testmd) | [syntax-highlight-test.md](syntax-highlight-test.md) | ⭐⭐⭐ | コード |
| 8 | [ローカル画像テスト](#8-ローカル画像テストlocal-images-testmd) | [local-images-test.md](local-images-test.md) | ⭐⭐ | 画像 |
| 9 | [リモート画像テスト](#9-リモート画像テストremote-images-testmd) | [remote-images-test.md](remote-images-test.md) | ⭐⭐ | 画像 |
| 10 | [パフォーマンステスト](#10-パフォーマンステストperformance-testmd) | [performance-test.md](performance-test.md) | ⭐⭐ | パフォーマンス |
| 11 | [セキュリティ＆機能テスト](#11-セキュリティ機能テストsecurity_testmd) | [security_test.md](security_test.md) | ⭐ | 統合 |

---

## 📋 テストファイル詳細

### 1. [基本機能テスト](basic-features.md)
**ファイル**: `basic-features.md`

Markdown基本構文とGitHub Flavored Markdown (GFM)の機能をテストします。

**テスト内容**:
- 見出し（H1〜H6）
- 段落と改行
- 強調（太字、斜体、打ち消し線）
- リスト（番号付き、番号なし、ネスト）
- タスクリスト（GFM）
- リンク（通常、自動リンク、内部リンク）
- 画像（data:URL）
- 引用（シンプル、ネスト）
- コード（インライン、コードブロック）
- テーブル（GFM）
- 水平線
- 複合的な要素

**推奨度**: ⭐⭐⭐⭐⭐ 最初に確認すべき基本テスト

---

### 2. [セキュリティテスト](security-tests.md)
**ファイル**: `security-tests.md`

DOMPurifyとContent Security Policy (CSP)によるXSS攻撃の防御機能をテストします。

**テスト内容**:
- scriptタグによる攻撃
- イベントハンドラによる攻撃（onclick, onerror, onloadなど）
- javascript:スキーム攻撃
- data:スキーム攻撃
- iframeによる攻撃
- object/embedによる攻撃
- styleによる攻撃
- SVGによる攻撃
- エンコーディングを使った攻撃
- 見出しとファイル名を使った攻撃

**期待される結果**: すべての攻撃がブロックされ、アラートは一切表示されない

**推奨度**: ⭐⭐⭐⭐⭐ セキュリティ確認のため必須

---

### 3. [HTMLタグテスト](html-tags-test.md)
**ファイル**: `html-tags-test.md`

GitHub互換のHTMLタグが正しく表示されることを確認します。

**テスト内容**:
- 安全なタグ（details/summary、kbd、mark、sub/sup、ins/del/s、tfoot）
- 危険なタグのエスケープ表示（script、iframe、form、style）
- イベントハンドラの削除確認

**期待される結果**:
- ✅ 安全なタグは正しく機能する
- ✅ 危険なタグは文字列として表示される（実行されない）
- ✅ イベントハンドラは削除される

**推奨度**: ⭐⭐⭐⭐ GitHub互換性確認のため重要

---

### 4. [KaTeX数式テスト](katex-tests.md)
**ファイル**: `katex-tests.md`

KaTeX数式レンダリング機能とそのセキュリティをテストします。

**テスト内容**:
- インライン数式（$...$、\(...\)）
- ディスプレイ数式（$$...$$、\[...\]）
- 基本的な数式要素（分数、累乗、根号）
- ギリシャ文字
- 演算子と記号
- 微積分
- 行列とベクトル
- 複雑な数式（フーリエ変換、シュレーディンガー方程式など）
- 場合分けと連立方程式
- 数式内のXSS攻撃テスト

**注意**: 右上の「TeX」ボタンをONにしてテストしてください。

**推奨度**: ⭐⭐⭐⭐ KaTeX機能を使用する場合は必須

---

### 5. [KaTeX $記号誤検知テスト](katex-dollar-sign-test.md)
**ファイル**: `katex-dollar-sign-test.md`

KaTeX数式レンダリングにおける`$`記号の誤検知を防ぐためのテストです。

**テスト内容**:
- 価格表示の正しい認識（`$10`, `$20`, `$100`など）
- 数式と価格の混在パターン
- GitHub互換ヒューリスティックの検証
  - 開始`$`: 直後が空白/タブでない
  - 終了`$`: 直前が空白/タブでない、直後が英数字でない
  - 内容: 英数字が含まれている
- 見出し内の数式記法無効化
- コードブロック・インラインコード内の保護
- 英数字を含まない数式記法（`$...$`, `$$...$$`, `\[...\]`, `\(...\)`）の無効化
- 約145+の詳細なテストパターン

**期待される結果**:
- ✅ 価格表示（`$10 and $20`など）はそのまま表示
- ✅ 数式（`$x=1$`, `$E=mc^2$`など）は正しくレンダリング
- ✅ 見出し内の数式記法はすべて無効化
- ✅ `$...$`, `$$...$$`などの記号のみのパターンは無効化

**推奨度**: ⭐⭐⭐⭐ KaTeX機能使用時は数式と価格の混在を扱う場合に重要

---

### 6. [Mermaidダイアグラムテスト](mermaid-tests.md)
**ファイル**: `mermaid-tests.md`

Mermaidダイアグラム描画機能をテストします。

**テスト内容**:
- フローチャート（基本、複雑、カラフル）
- シーケンス図（rect色分け、条件分岐）
- クラス図（style方式、classDef方式）
- 状態遷移図（基本、ネスト）
- ガントチャート（done/active/critパターン）
- ER図
- 円グラフ
- Gitグラフ
- 色変換テスト（明るい色、暗い色、中間色）

**注意**: Mermaidダイアグラムは常にライトテーマで表示されます（ダークモード時も白背景）。

**推奨度**: ⭐⭐⭐⭐ Mermaid機能を使用する場合は必須

---

### 6. [シンタックスハイライトテスト](syntax-highlight-test.md)
**ファイル**: `syntax-highlight-test.md`

コードブロックのシンタックスハイライト機能をテストします。

**テスト内容**:
- JavaScript/TypeScript
- Python
- Java
- Go
- Rust
- その他の言語（HTML, CSS, SQL, Bashなど）
- 言語指定なしのコードブロック

**推奨度**: ⭐⭐⭐ コードを含むMarkdownを使用する場合

---

### 8. [ローカル画像テスト](local-images-test.md)
**ファイル**: `local-images-test.md`

ローカル画像ファイルの表示機能をテストします。

**テスト内容**:
- 相対パスでの画像参照
- 絶対パスでの画像参照
- data:URLでの画像表示
- 外部URL画像（ブロックされるべき）

**注意**: 実際のローカル画像ファイルが必要です。

**推奨度**: ⭐⭐ ローカル画像を使用する場合

---

### 9. [リモート画像テスト](remote-images-test.md)
**ファイル**: `remote-images-test.md`

HTMLエクスポート機能のリモート画像埋め込みをテストします。

**テスト内容**:
- リモート画像のBase64変換（最大20MB/ファイル）
- 小さい画像（150x150, 300x200, 500x300）
- GitHub上の画像（GitHub Logo, Octocat）
- テーブル内のリモート画像
- インライン画像
- Mermaidダイアグラムとの組み合わせ
- KaTeX数式との組み合わせ
- エクスポート時の処理フロー検証

**期待される結果**:
- ✅ 20MB以下のリモート画像がBase64化される
- ✅ 20MB超のリモート画像はURLのまま保持
- ✅ MIMEタイプ検証（image/*のみ許可）
- ✅ エクスポートHTMLでオフライン表示可能

**推奨度**: ⭐⭐ リモート画像を含むMarkdownをエクスポートする場合

---

### 10. [パフォーマンステスト](performance-test.md)
**ファイル**: `performance-test.md`

大量のコンテンツを含む重負荷テストファイルです。

**テスト内容**:
- 大量のMarkdown要素
- 大量のシンタックスハイライト（JavaScript, Python, Java, Go, Rust, SQL）
- 複雑なMermaidダイアグラム（フローチャート、シーケンス図、クラス図など）
- 大量のKaTeX数式（微積分、線形代数、統計学、物理学の数式）
- 複合コンテンツ（数式+コード、Mermaid+テーブルなど）
- 大量の見出し（目次生成テスト）

**目的**:
- ページ読み込み時間の測定
- スクロールの滑らかさの確認
- 非同期レンダリングの効果検証
- メモリ使用量の確認

**推奨度**: ⭐⭐ パフォーマンス検証時のみ

---

### 11. [セキュリティ＆機能テスト](security_test.md)
**ファイル**: `security_test.md`

ライブラリアップデート後の統合テストファイルです。

**テスト内容**:
- KaTeX数式レンダリング（インライン、ディスプレイ、LaTeX形式）
- 価格表示の誤認識テスト
- XSS防御（DOMPurify）
  - scriptタグ、イベントハンドラー、JavaScript URL
  - HTML属性、SVG経由のXSS
- Markdownレンダリング（コードブロック、テーブル、タスクリスト、引用、画像）
- Mermaidダイアグラム（フローチャート、シーケンス図）
- KaTeX DoS対策（複雑な数式、マトリックス、積分）

**期待される結果**:
- ✅ すべての数式が正しくレンダリング
- ✅ 価格表示が誤認識されない
- ✅ すべてのXSS攻撃がブロックされる
- ✅ Markdown要素が正しく表示
- ✅ Mermaidダイアグラムが正しく描画
- ✅ 複雑な数式も正しく処理（DoS攻撃防止）

**推奨度**: ⭐ ライブラリアップデート後の確認用

---

## 🔍 推奨テスト順序

新しいバージョンをテストする際は、以下の順序でテストすることを推奨します：

1. **基本機能テスト** (`basic-features.md`)
   - すべての基本機能が動作することを確認

2. **セキュリティテスト** (`security-tests.md`)
   - XSS攻撃がブロックされることを確認
   - アラートが一切表示されないことを確認

3. **HTMLタグテスト** (`html-tags-test.md`)
   - GitHub互換のHTMLタグが正しく機能することを確認
   - 危険なタグがエスケープ表示されることを確認

4. **シンタックスハイライトテスト** (`syntax-highlight-test.md`)
   - コードブロックが正しくハイライトされることを確認

5. **KaTeX数式テスト** (`katex-tests.md`)
   - 数式が正しくレンダリングされることを確認
   - 数式内のXSS攻撃がブロックされることを確認

6. **KaTeX $記号誤検知テスト** (`katex-dollar-sign-test.md`)
   - 価格表示と数式が正しく区別されることを確認
   - GitHub互換ヒューリスティックの動作確認

7. **Mermaidダイアグラムテスト** (`mermaid-tests.md`)
   - すべての種類のダイアグラムが正しく描画されることを確認
   - ダークモード時も白背景で表示されることを確認

8. **リモート画像テスト** (`remote-images-test.md`)（オプション）
   - リモート画像のBase64変換とエクスポートが正しく動作することを確認

9. **パフォーマンステスト** (`performance-test.md`)（オプション）
   - 大量のコンテンツが正常に表示されることを確認
   - ページの読み込み速度とスクロール性能を確認

10. **ローカル画像テスト** (`local-images-test.md`)（オプション）
    - ローカル画像機能を使用する場合のみ

11. **セキュリティ＆機能テスト** (`security_test.md`)（オプション）
    - ライブラリアップデート後の統合確認

---

## ✅ テスト合格基準

すべてのテストが以下の条件を満たすことを確認してください：

### 基本機能
- [ ] すべてのMarkdown要素が正しくレンダリングされる
- [ ] GFM機能（タスクリスト、テーブル、打ち消し線）が動作する
- [ ] GitHubスタイルで表示される
- [ ] 目次が自動生成され、クリックでジャンプできる

### セキュリティ
- [ ] **アラートが一切表示されない**
- [ ] DOMPurifyがすべてのXSS攻撃をブロックしている
- [ ] F12コンソールに重大なエラーがない

### 機能
- [ ] シンタックスハイライトが正しく適用される
- [ ] KaTeX数式が正しくレンダリングされる
- [ ] 価格表示（`$10 and $20`など）が数式として誤認識されない
- [ ] Mermaidダイアグラムが正しく描画される
- [ ] ダークモード切り替えが正常に動作する
- [ ] 印刷機能が正常に動作する
- [ ] KaTeX ON/OFF切り替えが正常に動作する
- [ ] HTMLエクスポート機能が正常に動作する
- [ ] リモート画像がBase64化される（20MB以下）

### パフォーマンス
- [ ] 大量のコンテンツでも初期表示が高速（2秒以内）
- [ ] スクロールが滑らか
- [ ] ページがフリーズしない

---

## 🐛 問題が見つかった場合

テスト中に問題を見つけた場合は、以下の情報を記録してください：

1. **問題が発生したテストファイル**
2. **問題の内容**（スクリーンショット推奨）
3. **F12コンソールのエラーメッセージ**
4. **使用しているChromeのバージョン**
5. **再現手順**

---

## 📝 テストファイルの更新

新機能を追加した場合は、対応するテストファイルに新しいテストケースを追加してください。

- 基本的なMarkdown機能 → `basic-features.md`
- セキュリティ関連 → `security-tests.md`
- HTMLタグ機能 → `html-tags-test.md`
- 数式機能 → `katex-tests.md`または`katex-dollar-sign-test.md`
- ダイアグラム機能 → `mermaid-tests.md`
- シンタックスハイライト → `syntax-highlight-test.md`
- 画像機能 → `local-images-test.md`または`remote-images-test.md`
- パフォーマンス → `performance-test.md`
- 統合テスト → `security_test.md`
